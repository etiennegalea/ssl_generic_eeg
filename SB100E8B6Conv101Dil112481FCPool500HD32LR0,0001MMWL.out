Python 3.8.12
/var/scratch/ega470/ssl_thesis/braindecode/datautil/preprocess.py:10: UserWarning: datautil.preprocess module is deprecated and is now under preprocessing.preprocess, please use from import braindecode.preprocessing.preprocess
  warn('datautil.preprocess module is deprecated and is now under '
:: STARTING MAIN ::
╒══════════════════════╤═════════════════════════════════════════╕
│ dataset_name         │ sleep_staging                           │
├──────────────────────┼─────────────────────────────────────────┤
│ subject_size         │ sample                                  │
├──────────────────────┼─────────────────────────────────────────┤
│ random_state         │ 87                                      │
├──────────────────────┼─────────────────────────────────────────┤
│ n_jobs               │ 16                                      │
├──────────────────────┼─────────────────────────────────────────┤
│ window_size_s        │ 5                                       │
├──────────────────────┼─────────────────────────────────────────┤
│ low_cut_hz           │ 0.5                                     │
├──────────────────────┼─────────────────────────────────────────┤
│ high_cut_hz          │ 30                                      │
├──────────────────────┼─────────────────────────────────────────┤
│ sfreq                │ 100                                     │
├──────────────────────┼─────────────────────────────────────────┤
│ lr                   │ 0.005                                   │
├──────────────────────┼─────────────────────────────────────────┤
│ batch_size           │ 512                                     │
├──────────────────────┼─────────────────────────────────────────┤
│ n_channels           │ 2                                       │
├──────────────────────┼─────────────────────────────────────────┤
│ connectivity_plot    │ True                                    │
├──────────────────────┼─────────────────────────────────────────┤
│ edge_bundling_plot   │ True                                    │
├──────────────────────┼─────────────────────────────────────────┤
│ annotations          │ ['artifact', 'non-artifact', 'ignored'] │
├──────────────────────┼─────────────────────────────────────────┤
│ show_plots           │ False                                   │
├──────────────────────┼─────────────────────────────────────────┤
│ load_feature_vectors │                                         │
├──────────────────────┼─────────────────────────────────────────┤
│ load_latest_model    │ False                                   │
├──────────────────────┼─────────────────────────────────────────┤
│ fully_supervised     │ True                                    │
╘══════════════════════╧═════════════════════════════════════════╛
:: CUDA unavailable - using CPU
ContrastiveNet(
  (emb): SleepStagerChambon2018(
    (spatial_conv): Conv2d(1, 2, kernel_size=(2, 1), stride=(1, 1))
    (feature_extractor): Sequential(
      (0): Conv2d(1, 16, kernel_size=(1, 50), stride=(1, 1), padding=(0, 25))
      (1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU()
      (3): MaxPool2d(kernel_size=(1, 13), stride=(1, 13), padding=0, dilation=1, ceil_mode=False)
      (4): Conv2d(16, 16, kernel_size=(1, 50), stride=(1, 1), padding=(0, 25))
      (5): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (6): ReLU()
      (7): MaxPool2d(kernel_size=(1, 13), stride=(1, 13), padding=0, dilation=1, ceil_mode=False)
    )
    (fc): Sequential(
      (0): Dropout(p=0, inplace=False)
      (1): Linear(in_features=96, out_features=100, bias=True)
    )
  )
  (clf): Sequential(
    (0): Dropout(p=0.5, inplace=False)
    (1): Linear(in_features=100, out_features=1, bias=True)
  )
)
:: loading SPACE/BAMBI data
340 files found
Opening raw data file ./data/SPACE_BAMBI_2channels/BAMBI.S501.yyyymmdd.ECRASD1_raw.fif...
    Range : 0 ... 370687 =      0.000 ...   181.000 secs
Ready.
Opening raw data file ./data/SPACE_BAMBI_2channels/BAMBI.S501.yyyymmdd.EORASD1_raw.fif...
    Range : 0 ... 360447 =      0.000 ...   176.000 secs
Ready.
Opening raw data file ./data/SPACE_BAMBI_2channels/BAMBI.S502.yyyymmdd.ECRASD1_raw.fif...
    Range : 0 ... 397311 =      0.000 ...   194.000 secs
Ready.
Opening raw data file ./data/SPACE_BAMBI_2channels/BAMBI.S502.yyyymmdd.EORASD1_raw.fif...
    Range : 0 ... 370687 =      0.000 ...   181.000 secs
Ready.
Opening raw data file ./data/SPACE_BAMBI_2channels/BAMBI.S503.yyyymmdd.ECRASD1_raw.fif...
    Range : 0 ... 376831 =      0.000 ...   184.000 secs
Ready.
:: PREPROCESSING RAWS
--resample 100
--high_cut freq 30
--low_cut freq 0.5
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.5 - 30 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.50
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 0.25 Hz)
- Upper passband edge: 30.00 Hz
- Upper transition bandwidth: 7.50 Hz (-6 dB cutoff frequency: 33.75 Hz)
- Filter length: 661 samples (6.610 sec)

[Parallel(n_jobs=16)]: Using backend LokyBackend with 16 concurrent workers.
[Parallel(n_jobs=16)]: Done   2 out of   2 | elapsed:    1.4s remaining:    0.0s
[Parallel(n_jobs=16)]: Done   2 out of   2 | elapsed:    1.4s finished
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.5 - 30 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.50
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 0.25 Hz)
- Upper passband edge: 30.00 Hz
- Upper transition bandwidth: 7.50 Hz (-6 dB cutoff frequency: 33.75 Hz)
- Filter length: 661 samples (6.610 sec)

[Parallel(n_jobs=16)]: Using backend LokyBackend with 16 concurrent workers.
[Parallel(n_jobs=16)]: Done   2 out of   2 | elapsed:    1.1s remaining:    0.0s
[Parallel(n_jobs=16)]: Done   2 out of   2 | elapsed:    1.1s finished
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.5 - 30 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.50
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 0.25 Hz)
- Upper passband edge: 30.00 Hz
- Upper transition bandwidth: 7.50 Hz (-6 dB cutoff frequency: 33.75 Hz)
- Filter length: 661 samples (6.610 sec)

[Parallel(n_jobs=16)]: Using backend LokyBackend with 16 concurrent workers.
[Parallel(n_jobs=16)]: Done   2 out of   2 | elapsed:    1.0s remaining:    0.0s
[Parallel(n_jobs=16)]: Done   2 out of   2 | elapsed:    1.0s finished
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.5 - 30 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.50
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 0.25 Hz)
- Upper passband edge: 30.00 Hz
- Upper transition bandwidth: 7.50 Hz (-6 dB cutoff frequency: 33.75 Hz)
- Filter length: 661 samples (6.610 sec)

[Parallel(n_jobs=16)]: Using backend LokyBackend with 16 concurrent workers.
[Parallel(n_jobs=16)]: Done   2 out of   2 | elapsed:    0.9s remaining:    0.0s
[Parallel(n_jobs=16)]: Done   2 out of   2 | elapsed:    0.9s finished
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.5 - 30 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.50
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 0.25 Hz)
- Upper passband edge: 30.00 Hz
- Upper transition bandwidth: 7.50 Hz (-6 dB cutoff frequency: 33.75 Hz)
- Filter length: 661 samples (6.610 sec)

[Parallel(n_jobs=16)]: Using backend LokyBackend with 16 concurrent workers.
[Parallel(n_jobs=16)]: Done   2 out of   2 | elapsed:    1.0s remaining:    0.0s
[Parallel(n_jobs=16)]: Done   2 out of   2 | elapsed:    1.0s finished
Used Annotations descriptions: ['artifact', 'non-artifact']
Adding metadata with 4 columns
Replacing existing metadata with 4 columns
71 matching events found
No baseline correction applied
0 projection items activated
Loading data for 71 events and 500 original time points ...
0 bad epochs dropped
Used Annotations descriptions: ['artifact', 'non-artifact']
Adding metadata with 4 columns
Replacing existing metadata with 4 columns
69 matching events found
No baseline correction applied
0 projection items activated
Loading data for 69 events and 500 original time points ...
0 bad epochs dropped
Used Annotations descriptions: ['artifact', 'ignore', 'non-artifact']
Adding metadata with 4 columns
Replacing existing metadata with 4 columns
76 matching events found
No baseline correction applied
0 projection items activated
Loading data for 76 events and 500 original time points ...
0 bad epochs dropped
Used Annotations descriptions: ['artifact', 'ignore', 'non-artifact']
Adding metadata with 4 columns
Replacing existing metadata with 4 columns
71 matching events found
No baseline correction applied
0 projection items activated
Loading data for 71 events and 500 original time points ...
0 bad epochs dropped
Used Annotations descriptions: ['artifact', 'ignore', 'non-artifact']
Adding metadata with 4 columns
Replacing existing metadata with 4 columns
72 matching events found
No baseline correction applied
0 projection items activated
Loading data for 72 events and 500 original time points ...
0 bad epochs dropped
Loading data for 71 events and 500 original time points ...
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/utils/deprecation.py:86: FutureWarning: Function zscore is deprecated; will be removed in 0.7.0. Use sklearn.preprocessing.scale instead.
  warnings.warn(msg, category=FutureWarning)
Loading data for 69 events and 500 original time points ...
Loading data for 76 events and 500 original time points ...
Loading data for 71 events and 500 original time points ...
Loading data for 72 events and 500 original time points ...
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/model_selection/_split.py:670: UserWarning: The least populated class in y has only 3 members, which is less than n_splits=5.
  warnings.warn(("The least populated class in y has only %d"
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1814: UserWarning: y_pred contains classes not in y_true
  warnings.warn('y_pred contains classes not in y_true')
sleep_staging performance with logistic regression:
Train bal acc: 0.9403
Valid bal acc: 0.5149
Test bal acc: 0.5022
Results on test set:
[[46 17  1]
 [ 5  2  0]
 [ 0  0  0]]
:: plotting confusion matrix heatmap... Done
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

           0       0.90      0.72      0.80        64
           1       0.11      0.29      0.15         7
           2       0.00      0.00      0.00         0

    accuracy                           0.68        71
   macro avg       0.34      0.33      0.32        71
weighted avg       0.82      0.68      0.74        71

:: plotting PCA... Done
:: plotting TSNE... Done
:: plotting UMAP... Traceback (most recent call last):
  File "/var/scratch/ega470/ssl_thesis/ssl_rl_finetuning.py", line 945, in <module>
    main()
  File "/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/click/core.py", line 829, in __call__
    return self.main(*args, **kwargs)
  File "/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/click/core.py", line 782, in main
    rv = self.invoke(ctx)
  File "/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "/var/scratch/ega470/ssl_thesis/ssl_rl_finetuning.py", line 262, in main
    p.plot_UMAP(X, y, annotations)
  File "/var/scratch/ega470/ssl_thesis/plot.py", line 129, in plot_UMAP
    _umap = umap.UMAP(n_neighbors=15)
NameError: name 'umap' is not defined
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/model_selection/_validation.py:548: FitFailedWarning: Estimator fit failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/model_selection/_validation.py", line 531, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/pipeline.py", line 335, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py", line 1370, in fit
    raise ValueError("This solver needs samples of at least 2 classes"
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1

  warnings.warn("Estimator fit failed. The score on this train-test"
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1814: UserWarning: y_pred contains classes not in y_true
  warnings.warn('y_pred contains classes not in y_true')
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1814: UserWarning: y_pred contains classes not in y_true
  warnings.warn('y_pred contains classes not in y_true')
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/model_selection/_validation.py:548: FitFailedWarning: Estimator fit failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/model_selection/_validation.py", line 531, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/pipeline.py", line 335, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py", line 1370, in fit
    raise ValueError("This solver needs samples of at least 2 classes"
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1

  warnings.warn("Estimator fit failed. The score on this train-test"
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1814: UserWarning: y_pred contains classes not in y_true
  warnings.warn('y_pred contains classes not in y_true')
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1814: UserWarning: y_pred contains classes not in y_true
  warnings.warn('y_pred contains classes not in y_true')
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1814: UserWarning: y_pred contains classes not in y_true
  warnings.warn('y_pred contains classes not in y_true')
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/model_selection/_validation.py:548: FitFailedWarning: Estimator fit failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/model_selection/_validation.py", line 531, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/pipeline.py", line 335, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py", line 1370, in fit
    raise ValueError("This solver needs samples of at least 2 classes"
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 0

  warnings.warn("Estimator fit failed. The score on this train-test"
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1814: UserWarning: y_pred contains classes not in y_true
  warnings.warn('y_pred contains classes not in y_true')
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1814: UserWarning: y_pred contains classes not in y_true
  warnings.warn('y_pred contains classes not in y_true')
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1814: UserWarning: y_pred contains classes not in y_true
  warnings.warn('y_pred contains classes not in y_true')
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1814: UserWarning: y_pred contains classes not in y_true
  warnings.warn('y_pred contains classes not in y_true')
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1814: UserWarning: y_pred contains classes not in y_true
  warnings.warn('y_pred contains classes not in y_true')
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/model_selection/_validation.py:548: FitFailedWarning: Estimator fit failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/model_selection/_validation.py", line 531, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/pipeline.py", line 335, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py", line 1370, in fit
    raise ValueError("This solver needs samples of at least 2 classes"
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 0

  warnings.warn("Estimator fit failed. The score on this train-test"
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1814: UserWarning: y_pred contains classes not in y_true
  warnings.warn('y_pred contains classes not in y_true')
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1814: UserWarning: y_pred contains classes not in y_true
  warnings.warn('y_pred contains classes not in y_true')
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1814: UserWarning: y_pred contains classes not in y_true
  warnings.warn('y_pred contains classes not in y_true')
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/model_selection/_validation.py:548: FitFailedWarning: Estimator fit failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/model_selection/_validation.py", line 531, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/pipeline.py", line 335, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py", line 1370, in fit
    raise ValueError("This solver needs samples of at least 2 classes"
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 0

  warnings.warn("Estimator fit failed. The score on this train-test"
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1814: UserWarning: y_pred contains classes not in y_true
  warnings.warn('y_pred contains classes not in y_true')
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1814: UserWarning: y_pred contains classes not in y_true
  warnings.warn('y_pred contains classes not in y_true')
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1814: UserWarning: y_pred contains classes not in y_true
  warnings.warn('y_pred contains classes not in y_true')
/var/scratch/ega470/envs/ssl/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1814: UserWarning: y_pred contains classes not in y_true
  warnings.warn('y_pred contains classes not in y_true')
